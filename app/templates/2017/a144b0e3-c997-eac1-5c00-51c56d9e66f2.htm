{% macro header() %}<title>TessellatedShapeBuilder Class</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="a144b0e3-c997-eac1-5c00-51c56d9e66f2" /><meta name="guid" content="a144b0e3-c997-eac1-5c00-51c56d9e66f2" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2017 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">TessellatedShapeBuilder Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="a2e292ce-8cc5-df9e-98c4-f28e32ae0932.htm">Members</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2017 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   A class that permits structured building of geometry or
   a mesh from a collection of connected faces.
   Contains all closed face sets and custom precisions.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 17.0.0.0 (17.0.484.0)<br /><b>Since:</b> 
   2015
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">TessellatedShapeBuilder</span> : <a href="66c1678c-2e01-e0de-1386-5a0e1eb3ccff.htm">ShapeBuilder</a></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">TessellatedShapeBuilder</span> _
	<span class="keyword">Inherits</span> <a href="66c1678c-2e01-e0de-1386-5a0e1eb3ccff.htm">ShapeBuilder</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">TessellatedShapeBuilder</span> : <span class="keyword">public</span> <a href="66c1678c-2e01-e0de-1386-5a0e1eb3ccff.htm">ShapeBuilder</a></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
   Creates a geometry populated with a shell or a connected solid (a
   solid may have inner voids) from the sets of connected faces.
   All faces are planar and have polyline boundaries, defined
   as sequences of 3d coordinates.
   Faces are added to the builder as a part of face sets,
   representing faces which share edges
   (e.g., outer 'surface' of a solid or inner 'surface'
   of solid voids). Order of faces in sets is irrelevant. Faces can only
   be added to the build while a face set is "open" (use
   <a href="186da29a-caa2-99ea-1b2a-722c1656c44a.htm">OpenConnectedFaceSet(Boolean)</a> to open a face set).
   Before attempting to build Revit geometry from the builder
   the current face set should be closed
   (<a href="0bebb71c-317e-3dbc-1304-169561e22214.htm">CloseConnectedFaceSet<span class="languageSpecificText"><span class="cs">()</span><span class="cpp">()</span><span class="nu">()</span><span class="fs">()</span></span></a>).
   The builder allows for the possibility of multiple face
   sets - in such cases the first set should represent the
   outer 'surface' of a body and all following sets
   represent interior voids.
   The builder tries to create a geometry valid in Revit despite
   inconsistencies or omissions in the input data.
</div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Create a pyramid-shaped DirectShape using given material for the faces</span>
<span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> CreateTessellatedShape(Document doc, ElementId materialId)
{
    List&lt;XYZ&gt; loopVertices = <span class="highlight-keyword">new</span> List&lt;XYZ&gt;(<span class="highlight-number">4</span>);

    TessellatedShapeBuilder builder = <span class="highlight-keyword">new</span> TessellatedShapeBuilder();

    builder.OpenConnectedFaceSet(<span class="highlight-keyword">true</span>);
    <span class="highlight-comment">// create a pyramid with a square base 4' x 4' and 5' high</span>
    <span class="highlight-keyword">double</span> length = <span class="highlight-number">4.0</span>;
    <span class="highlight-keyword">double</span> height = <span class="highlight-number">5.0</span>;

    XYZ basePt1 = XYZ.Zero;
    XYZ basePt2 = <span class="highlight-keyword">new</span> XYZ(length, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
    XYZ basePt3 = <span class="highlight-keyword">new</span> XYZ(length, length, <span class="highlight-number">0</span>);
    XYZ basePt4 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, length, <span class="highlight-number">0</span>);
    XYZ apex = <span class="highlight-keyword">new</span> XYZ(length / <span class="highlight-number">2</span>, length / <span class="highlight-number">2</span>, height);

    loopVertices.Add(basePt1);
    loopVertices.Add(basePt2);
    loopVertices.Add(basePt3);
    loopVertices.Add(basePt4);
    builder.AddFace(<span class="highlight-keyword">new</span> TessellatedFace(loopVertices, materialId));

    loopVertices.Clear();
    loopVertices.Add(basePt1);
    loopVertices.Add(apex);
    loopVertices.Add(basePt2);
    builder.AddFace(<span class="highlight-keyword">new</span> TessellatedFace(loopVertices, materialId));

    loopVertices.Clear();
    loopVertices.Add(basePt2);
    loopVertices.Add(apex);
    loopVertices.Add(basePt3);
    builder.AddFace(<span class="highlight-keyword">new</span> TessellatedFace(loopVertices, materialId));

    loopVertices.Clear();
    loopVertices.Add(basePt3);
    loopVertices.Add(apex);
    loopVertices.Add(basePt4);
    builder.AddFace(<span class="highlight-keyword">new</span> TessellatedFace(loopVertices, materialId));

    loopVertices.Clear();
    loopVertices.Add(basePt4);
    loopVertices.Add(apex);
    loopVertices.Add(basePt1);
    builder.AddFace(<span class="highlight-keyword">new</span> TessellatedFace(loopVertices, materialId));

    builder.CloseConnectedFaceSet();
    builder.Build();

    TessellatedShapeBuilderResult result = builder.GetBuildResult();

    <span class="highlight-keyword">using</span> (Transaction t = <span class="highlight-keyword">new</span> Transaction(doc, <span class="highlight-literal">"Create tessellated direct shape"</span>))
    {
        t.Start();

        DirectShape ds = DirectShape.CreateElement(doc, <span class="highlight-keyword">new</span> ElementId(BuiltInCategory.OST_GenericModel));
       ds.ApplicationId = <span class="highlight-literal">"Application id"</span>;
       ds.ApplicationDataId = <span class="highlight-literal">"Geometry object id"</span>;

        ds.SetShape(result.GetGeometricalObjects());
        t.Commit();
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Create a pyramid-shaped DirectShape using given material for the faces</span>
<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> CreateTessellatedShape(doc <span class="highlight-keyword">As</span> Document, materialId <span class="highlight-keyword">As</span> ElementId)
    <span class="highlight-keyword">Dim</span> loopVertices <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> XYZ)(<span class="highlight-number">4</span>)

    <span class="highlight-keyword">Dim</span> builder <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> TessellatedShapeBuilder()

    builder.OpenConnectedFaceSet(<span class="highlight-keyword">True</span>)
    <span class="highlight-comment">' create a pyramid with a square base 4' x 4' and 5' high</span>
    <span class="highlight-keyword">Dim</span> length <span class="highlight-keyword">As</span> <span class="highlight-keyword">Double</span> = <span class="highlight-number">4.0</span>
    <span class="highlight-keyword">Dim</span> height <span class="highlight-keyword">As</span> <span class="highlight-keyword">Double</span> = <span class="highlight-number">5.0</span>

    <span class="highlight-keyword">Dim</span> basePt1 <span class="highlight-keyword">As</span> XYZ = XYZ.Zero
    <span class="highlight-keyword">Dim</span> basePt2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(length, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
    <span class="highlight-keyword">Dim</span> basePt3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(length, length, <span class="highlight-number">0</span>)
    <span class="highlight-keyword">Dim</span> basePt4 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, length, <span class="highlight-number">0</span>)
    <span class="highlight-keyword">Dim</span> apex <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(length / <span class="highlight-number">2</span>, length / <span class="highlight-number">2</span>, height)

    loopVertices.Add(basePt1)
    loopVertices.Add(basePt2)
    loopVertices.Add(basePt3)
    loopVertices.Add(basePt4)
    builder.AddFace(<span class="highlight-keyword">New</span> TessellatedFace(loopVertices, materialId))

    loopVertices.Clear()
    loopVertices.Add(basePt1)
    loopVertices.Add(apex)
    loopVertices.Add(basePt2)
    builder.AddFace(<span class="highlight-keyword">New</span> TessellatedFace(loopVertices, materialId))

    loopVertices.Clear()
    loopVertices.Add(basePt2)
    loopVertices.Add(apex)
    loopVertices.Add(basePt3)
    builder.AddFace(<span class="highlight-keyword">New</span> TessellatedFace(loopVertices, materialId))

    loopVertices.Clear()
    loopVertices.Add(basePt3)
    loopVertices.Add(apex)
    loopVertices.Add(basePt4)
    builder.AddFace(<span class="highlight-keyword">New</span> TessellatedFace(loopVertices, materialId))

    loopVertices.Clear()
    loopVertices.Add(basePt4)
    loopVertices.Add(apex)
    loopVertices.Add(basePt1)
    builder.AddFace(<span class="highlight-keyword">New</span> TessellatedFace(loopVertices, materialId))

 builder.CloseConnectedFaceSet()
 builder.Build()

 <span class="highlight-keyword">Dim</span> result <span class="highlight-keyword">As</span> TessellatedShapeBuilderResult = builder.GetBuildResult()

    <span class="highlight-keyword">Using</span> t <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(doc, <span class="highlight-literal">"Create tessellated direct shape"</span>)
        t.Start()

    <span class="highlight-keyword">Dim</span> ds <span class="highlight-keyword">As</span> DirectShape = DirectShape.CreateElement(doc, <span class="highlight-keyword">New</span> ElementId(BuiltInCategory.OST_GenericModel))
    ds.ApplicationId = <span class="highlight-literal">"Application id"</span>
    ds.ApplicationDataId = <span class="highlight-literal">"Geometry object id"</span>

        ds.SetShape(result.GetGeometricalObjects())
        t.Commit()
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</a><br />  <a href="66c1678c-2e01-e0de-1386-5a0e1eb3ccff.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ShapeBuilder</a><br />    <span class="selflink">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>TessellatedShapeBuilder</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="a2e292ce-8cc5-df9e-98c4-f28e32ae0932.htm">TessellatedShapeBuilder Members</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
